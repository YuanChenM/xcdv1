<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.msk.pd.logic.IPD141131Logic">

    <select id="count" resultType="int">
        SELECT
        COUNT(DISTINCT(B.STANDARD_ID))
        FROM PD_ORG_STD B
        LEFT JOIN PD_STANDARD A ON A.STANDARD_ID = B.STANDARD_ID
    </select>

    <select id="findList" parameterType="BaseParam" resultType="com.msk.pd.bean.IPD141131RsOrgBean">
        SELECT
        A.ORG_STD_ITEM_ID AS orgStdItemId
        ,C.ORG_STD_ITEM_NAME AS orgStdItemName
        ,A.ORG_GOOD_VAL AS goodVal
        ,A.ORG_NORMAL_VAL AS normalVal
        ,A.ORG_BAD_VAL AS badVal
        FROM
        PD_ORG_STD AS A
        LEFT JOIN PD_ORG_STD_ITEM C ON A.ORG_STD_ITEM_ID = C.ORG_STD_ITEM_ID
        WHERE  A.STANDARD_ID = #{filterMap.standardId}
        ORDER BY A.ORG_STD_ITEM_ID
    </select>

    <select id="getPageCount" resultType="int">
        SELECT
        COUNT(DISTINCT(B.STANDARD_ID))
        FROM PD_ORG_STD B
        LEFT JOIN PD_STANDARD A ON A.STANDARD_ID = B.STANDARD_ID
    </select>

    <select id="findPageList" parameterType="com.msk.pd.bean.IPD141131RsParam"
            resultType="com.msk.pd.bean.IPD141131RsBean">
        SELECT
        DISTINCT(B.STANDARD_ID) AS standardId
        ,A.CLASSES_CODE AS classesCode
        ,A.BREED_CODE AS breedCode
        ,A.MACHINING_CODE AS machiningCode
        ,NULLIF(A.FEATURE_CODE,'') AS featureCode
        FROM PD_ORG_STD B
        LEFT JOIN PD_STANDARD A ON A.STANDARD_ID = B.STANDARD_ID
        ORDER BY B.STANDARD_ID
        <if test="startPos>=0 and pageCount>0">
            LIMIT #{startPos}, #{pageCount}
        </if>
    </select>
</mapper>
